

# 프로세스

- 실행 중인 프로그램
- 디스크에서 메모리로 적재되어, CPU 자원의 할당을 받을 수 있는 것

- 메모리 영역 : <u>스택, 힙, 데이터, 코드 영역</u>



## PCB

- Process Control Block, 프로세스 컨트롤 블록
- 프로세스의 중요 정보 저장
- 운영체제가 프로세스를 표현한 것
- 프로세스 생성 시 만들어진다
- 주기억장치에 유지된다.
- 문맥 전환 등 다른 프로세스 처리 시: PCB에 현재 상태 저장 -> 나중에 그 작업 상태를 불러와서 작업 재개
- 저장되는 정보 : PID, 상태, 다음 명령어 정보



## PC

- Program Counter
- 다음에 실행될 명령어 주소가 저장된 레지스터
- 명령어가 인출되면 -> 자동으로 다음 명령어를 가르키도록 주소값 증가



## 캐시 메모리

- CPU - 레지스터 사이
- 캐싱을 통해 병목 현상 완화



# 쓰레드

- <u>프로세스의 작업 실행 단위</u>
- 멀티 스레드 : 한 프로세스 내의 여러 프로그램 흐름
- 스레드 간에는 프로세스의 주소, 자원 공유
- 스레드 구성: 스레드 ID, PC, 레지스터 집합, 스택
- 스레드마다 스택과 PC 레지스터는 따로 있다 : 각자 독립적으로 작업을 수행해야 해서



## 멀티 스레드 환경

- 1 프로세스 N 실행 단위
- 자원 생성, 관리 중복성 최소화 효율성 증가
- 장점
  1. 멀티 프로세스에 비해 메모리와 자원 소모 감소
  2. 힙 영역을 사용하는 스레드간의 통신이 프로세스간 통신보다 훨씬 간단하다
  3. 스레드 간의 문잭전환이 프로세스의 문맥 전환보다 빠르다 : 캐시 메모리를 비울 필요가 없어서
  4. 시스템 처리량 증가, 공간, 시간, 자원 증가
- 단점
  1. 힙 영역을 공유하기 때문에, 해당 자원 사용할 때 동기화 필요
  2. 동기화를 위해 과도한 락 사용 시, 병목 현상 때문에 성능이 저하될 수 있음
- 멀티 스레드 VS 멀티 프로세스
  - 공통점 : 실행 단위를 구분한다.
  - 멀티 스레드는 자원을 덜 소모하지만
    - 하나의 스레드가 비정상적 오류를 발생시키면 다른 스레드도 종료됨
    - 동기화 문제
  - 멀티 프로세스는 자원 공유X
    - 서로간 통신이 불표
    - CPU 자원 더 많이 소모



## 멀티 프로세싱 VS 멀티 프로그래밍 VS 멀티 태스킹

CPU 코어 관점

1. N CPU코어 N프로세스 수행 -> 멀티 프로세싱
2. N CPU코어 N프로세스 수행 -> 멀티 프로그래밍
3. CPU 코어 몇 개를 쓰던 간에 작업을 수행한다 (프로세스보다 확장된 의미) -> 멀티 태스킹



# 프로세스 (스레드) 동기화

## 경쟁 상태 (Race Condition)

> 경쟁 상태란, 두 개 이상의 프로세스 혹은 스레드가 
> 1) 공유 자원을 동시에 사용할 때 
> 2) 그 순서에 따라 결과가 달라지는 문제



## 임계 영역과 크리티컬 섹션

> - 임계 영역 : 프로세스간 자원이 공유될 수 있는 코드 블록
> - 크리티컬 섹션: 동기화 방법

임계 영역을 프로세스들이 같이 쓸 수 있는 전제 조건

1. 상호 배제 (Mutual Exclusion) : 프로세스가 크리티컬 섹션에 들어가 있다면, 다른 프로세스는 CS에 들어갈 수 없다.
2. 진행 (Progress) : 크리티컬 섹션에 들어가 있는 프로세스가 없다면 다른 후보 프로세스가 진입할 수 있다.
3. 한정된 대기 (Bounded Waiting) : 프로세스가 진입 가능한 횟수에는 제한이 있다. (특정한 한 프로세스만 계속 진입하는 것을 방지)



## Lock

- 하드웨어 기반 처리
- 임계 영역에 진입하기 위해서는 Lock이 필요하다.
- 임계 영역에 들어가는 프로세스는 Lock을 획득하고, 빠져 나올 때 반납한다.
- 다중 처리기 환경에서는 성능 보장 x



## 세마포어

- 카운팅 세마포어
  - 동시에 사용 가능한 자원에 대해 사용되며
  - 임계영역 안에




[출처1](https://velog.io/@hygoogi/%EA%B8%B0%EC%88%A0%EB%A9%B4%EC%A0%91-%EC%A4%80%EB%B9%84%ED%95%98%EA%B8%B0)